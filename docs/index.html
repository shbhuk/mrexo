<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.6.2" />
<title>mrexo API documentation</title>
<meta name="description" content="﻿
MRExo …" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase;cursor:pointer}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>mrexo</code></h1>
</header>
<section id="section-intro">
<p>﻿</p>
<h1 id="mrexo">MRExo</h1>
<p><a href="https://doi.org/10.5281/zenodo.3306969"><img alt="DOI" src="https://zenodo.org/badge/DOI/10.5281/zenodo.3306969.svg"></a></p>
<p><a href="https://shbhuk.github.io/mrexo/">MRExo</a> is a Python package to jointly model distributions beyond two dimensions. Our updated framework can now simultaneously model up to four observables, while also incorporating asymmetric measurement uncertainties and upper limits in the data.
We build upon the 2-dimensional nonparametric framework utilizing beta density functions as the basis set for density estimation to perform simultaneous density estimation in up to 4-dimensions.
For detailed description of the code please see <a href="https://ui.adsabs.harvard.edu/abs/2019ApJ...882...38K">Kanodia et al. (2019)</a> for the original and <a href="https://ui.adsabs.harvard.edu/abs/2023arXiv230810615K">Kanodia et al. (2023)</a> for the updated version.</p>


The code also includes <strong>predicting functions</strong> (M-&gt;R, and R-&gt;M), and <strong>plotting</strong> functions to generate the plots used in the below preprint.</p>
<p>For detailed description of the code please see <a href="http://bit.ly/mrexo_paper">Kanodia et al. (2019)</a></p>
<p>==================</p>
<h2 id="installation"><strong>Installation</strong></h2>
<h3 id="linuxunix">Linux/Unix</h3>
<ol>
<li>
<p>In the terminal -
<code>pip install mrexo</code></p>
</li>
<li>
<p>In the terminal -
<code>pip install git+&lt;https://github.com/shbhuk/mrexo.git&gt; -U</code></p>
</li>
</ol>
<p>OR</p>
<ol>
<li>In the terminal -
<code>pip install git+ssh://git@github.com/shbhuk/mrexo.git -U</code></li>
</ol>
<p>OR </p>
<ol>
<li>
<p>In the terminal -
<code>git clone &lt;https://github.com/shbhuk/mrexo</code>&gt;</p>
</li>
<li>
<p>In the repository directory
<code>python setup.py install</code></p>
</li>
</ol>
<p>The -U is to upgrade the dependencies.</p>
<h3 id="windows">Windows</h3>
<ol>
<li>
<p>Install Git - <a href="https://git-for-windows.github.io/">Git for Windows</a></p>
</li>
<li>
<p>Install pip - <a href="https://pip.pypa.io/en/stable/installing/">pip for Windows</a></p>
</li>
<li>
<p>In cmd or git cmd -
<code>pip install git+&lt;https://github.com/shbhuk/mrexo.git&gt; -U</code></p>
</li>
</ol>
<p>OR </p>
<p><code>pip install mrexo</code></p>
<p>OR </p>
<p>Clone or Download the zip file and then in the repository directory
<code>python setup.py install</code></p>
<p>To sign up for updates, please join the Google Group linked here - <a href="https://groups.google.com/forum/#!forum/mrexo">https://groups.google.com/forum/#!forum/mrexo</a></p>
<p>================== </p>
<h2 id="citation"><strong>Citation</strong></h2>
<p>Guidelines to cite this package can be found <a href="https://github.com/AASJournals/Tutorials/blob/master/Repositories/CitingRepositories.md">here</a>.</p>
<p>The relevant paper can be found on <a href="http://bit.ly/mrexo_paper">ADS</a>.</p>
<p>==================
﻿</p>
<h2 id="package-dependencies-for-mrexo"><strong>Package dependencies for MRExo</strong></h2>
<ol>
<li>Astropy (v&gt;2.0)</li>
<li>Numpy </li>
<li>SciPy</li>
<li>Matplotlib</li>
<li>Functools32 if running Python 2.7, else Functools</li>
</ol>
<p>==================
﻿</p>
<h2 id="sample-script-to-predict-massradius"><strong>Sample script to predict Mass/Radius</strong></h2>
<p>Sample script to show how to use the predicting function to predict mass from radius</p>
<pre><code class="python">from mrexo import predict_from_measurement, generate_lookup_table
import os
import numpy as np
import matplotlib.pyplot as plt


try :
    pwd = os.path.dirname(__file__)
except NameError:
    pwd = ''
    print('Could not find pwd')

</code></pre>
<p>Sample script to show how to use the predicting function to predict mass from radius</p>
<p><strong>I.</strong> Predict mass and quantiles from radius for a 1 Earth radii planet with an uncertainty of 0.1 radii using the M dwarf fit from the result_dir</p>
<pre><code class="python">result_dir = os.path.join(pwd,'M_dwarfs_dummy')
predicted_mass, qtls, iron_planet = predict_from_measurement(measurement=1, measurement_sigma=0.1, result_dir=result_dir, is_posterior=False, show_plot=False)
print(predicted_mass)
</code></pre>
<p><strong>II.</strong> Predict mass from radius for the Kepler dataset for a 1 Earth radii planet</p>
<pre><code class="python">predicted_mass, qtls, iron_planet = predict_from_measurement(measurement=1, measurement_sigma=None, predict = 'mass', dataset='kepler')
</code></pre>
<p><strong>III.</strong> Predict the mass measurement from a dummy radius posterior and plot it</p>
<pre><code class="python">posterior, iron_planet = predict_from_measurement(measurement=np.random.normal(1,0.1,1000),
            measurement_sigma=None, result_dir=None, dataset='mdwarf', is_posterior=True, show_plot=True, use_lookup = True)
</code></pre>
<p><strong>IV.</strong> Predict the mass for a radius of 1 Earth radii exoplanet with uncertainty of 0.1 Earth Radii on the included Mdwarf fit.
Also output 5,16,84,95% quantile</p>
<pre><code class="python">predicted_mass, qtls, iron_planet = predict_from_measurement(measurement=1, measurement_sigma=0.1, result_dir=None, dataset='mdwarf', is_posterior=False,
                       qtl = [0.05,0.16,0.84,0.95], show_plot=False)
</code></pre>
<p>Alternatively, the default dataset is the M dwarf dataset from Kanodia 2019.
</p>
<pre><code class="python">predicted_mass, qtls, iron_planet = predict_from_measurement(measurement=1, measurement_sigma=0.1,qtl = [0.05,0.16,0.84,0.95])
</code></pre>
<p>==================</p>
<h2 id="sample-script-to-plot-mass-radius-relationships"><strong>Sample script to plot Mass-Radius relationships</strong></h2>
<p>Sample script to show how to use the plotting functions available with MRExo</p>
<pre><code class="python">from mrexo import plot_r_given_m_relation, plot_m_given_r_relation, plot_mr_and_rm, plot_joint_mr_distribution
import os
import numpy as np
import matplotlib.pyplot as plt


try :
    pwd = os.path.dirname(__file__)
except NameError:
    pwd = ''
    print('Could not find pwd')

</code></pre>
<p>Sample script to show how to use the plotting functions for the M dwarf dataset from Kanodia (2019)</p>
<pre><code class="python">mdwarf_result = r'C:\Users\shbhu\Documents\GitHub\mrexo\mrexo\datasets\M_dwarfs_20181214'
kepler_result = r'C:\Users\shbhu\Documents\Git\mrexo\mrexo\datasets\Kepler_Ning_etal_20170605'

result_dir = mdwarf_result
</code></pre>
<p><strong>I.</strong> Plot the conditional distribution f(m|r)</p>
<pre><code class="python">ax = plot_m_given_r_relation(result_dir)
</code></pre>
<p><strong> II.</strong> Plot the conditional distribution f(r|m)</p>
<pre><code class="python">ax = plot_r_given_m_relation(result_dir)
</code></pre>
<p><strong> III.</strong> Plot both the conditional distributions f(m|r) and f(r|m), similar to Kanodia 2019, Fig 3.</p>
<pre><code class="python">ax = plot_mr_and_rm(result_dir)
</code></pre>
<p><strong> IV.</strong> Plot the joint distribution f(m,r)</p>
<pre><code class="python">ax = plot_joint_mr_distribution(result_dir)
</code></pre>
<p>==================</p>
<h2 id="sample-script-to-fit-mass-radius-relationship"><strong>Sample script to fit mass-radius relationship</strong></h2>
<p>The CSV table is generated from the NASA Exoplanet Archive. The existing example
is for the 24 M dwarf planets as explained in Kanodia 2019.
This can be replaced with a different dataset CSV file.</p>
<p>For this sample, the cross validation has already been performed and the optimum number of
degrees has been established to be 17. For a new sample, set select_deg = 'cv' to
use cross validation to find the optimum number of degrees. </p>
<p>Can use parallel processing by setting cores &gt; 1.
To use all the cores in the CPU, cores=cpu_count() (from multiprocessing import cpu_count)</p>
<p>To bootstrap and estimate the robustness of the median, set num_boot &gt; 1.
If cores &gt; 1, then uses parallel processing to run the various boots. For large datasets,
first run with num_boot to be a smaller number to estimate the computational time.</p>
<p>For more detailed guidelines read the docuemtnation for the fit_mr_relation() function. </p>
<pre><code class="python">import os
from astropy.table import Table
import numpy as np
from multiprocessing import cpu_count
import numpy as np


from mrexo import fit_mr_relation


try :
    pwd = os.path.dirname(__file__)
except NameError:
    pwd = ''
    print('Could not find pwd')

t = Table.read(os.path.join(pwd,'Cool_stars_MR_20181214_exc_upperlim.csv'))

# Symmetrical errorbars
Mass_sigma = (abs(t['pl_masseerr1']) + abs(t['pl_masseerr2']))/2
Radius_sigma = (abs(t['pl_radeerr1']) + abs(t['pl_radeerr2']))/2

# In Earth units
Mass = np.array(t['pl_masse'])
Radius = np.array(t['pl_rade'])

# Directory to store results in
result_dir = os.path.join(pwd,'M_dwarfs_new_cv')

# Run with 50 bootstraps. Selecting degrees to be 17. Alternatively can set select_deg = 'cv' to
# find the optimum number of degrees.

if __name__ == '__main__':
            initialfit_result, bootstrap_results = fit_mr_relation(Mass = Mass, Mass_sigma = Mass_sigma,
                                                Radius = Radius, Radius_sigma = Radius_sigma,
                                                save_path = result_dir, select_deg = 17,
                                                num_boot = 50, cores = cpu_count())
</code></pre>
<p>==================</p>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">&#34;&#34;&#34;
.. include:: ../README.md
.. include:: ../docs/dependencies.md
.. include:: ../docs/sample_usage.md

&#34;&#34;&#34;

from .plot import plot_m_given_r_relation, plot_r_given_m_relation,plot_mr_and_rm, plot_joint_mr_distribution, plot_mle_weights
from .predict import predict_from_measurement, mass_100_percent_iron_planet,generate_lookup_table, radius_100_percent_iron_planet
from .fit import fit_mr_relation
from .mle_utils import MLE_fit, cond_density_quantile
from .utils import _save_dictionary, _load_lookup_table, _logging
from .cross_validate import run_cross_validation

__version__ = &#39;0.1.4.1&#39;</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="mrexo.cross_validate" href="cross_validate.html">mrexo.cross_validate</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="mrexo.fit" href="fit.html">mrexo.fit</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="mrexo.mle_utils" href="mle_utils.html">mrexo.mle_utils</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="mrexo.plot" href="plot.html">mrexo.plot</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="mrexo.predict" href="predict.html">mrexo.predict</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="mrexo.utils" href="utils.html">mrexo.utils</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#mrexo">MRExo</a><ul>
<li><a href="#installation">Installation</a><ul>
<li><a href="#linuxunix">Linux/Unix</a></li>
<li><a href="#windows">Windows</a></li>
</ul>
</li>
<li><a href="#citation">Citation</a></li>
<li><a href="#package-dependencies-for-mrexo">Package dependencies for MRExo</a></li>
<li><a href="#sample-script-to-predict-massradius">Sample script to predict Mass/Radius</a></li>
<li><a href="#sample-script-to-plot-mass-radius-relationships">Sample script to plot Mass-Radius relationships</a></li>
<li><a href="#sample-script-to-fit-mass-radius-relationship">Sample script to fit mass-radius relationship</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="mrexo.cross_validate" href="cross_validate.html">mrexo.cross_validate</a></code></li>
<li><code><a title="mrexo.fit" href="fit.html">mrexo.fit</a></code></li>
<li><code><a title="mrexo.mle_utils" href="mle_utils.html">mrexo.mle_utils</a></code></li>
<li><code><a title="mrexo.plot" href="plot.html">mrexo.plot</a></code></li>
<li><code><a title="mrexo.predict" href="predict.html">mrexo.predict</a></code></li>
<li><code><a title="mrexo.utils" href="utils.html">mrexo.utils</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.6.2</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>
